{% extends "layout.html" %}
{% block data %}

<script>
    var targetContainer = document.getElementById("target_div");
    var eventSource = new EventSource("/stream")
    var table = document.createElement('table');
    table.id = 'cost_data';
    eventSource.onmessage = function(e) {
        console.log(e)
        table.innerHTML = "";

        var dict = JSON.parse(e.data);
        for (var i = 1; i < dict.length; i++){
            var tr = document.createElement('tr');   

            var td1 = document.createElement('td');
            var td2 = document.createElement('td');
            var td3 = document.createElement('td');
            var text1 = document.createTextNode(dict[i]['Market']);
            var text2 = document.createTextNode(dict[i]['Value']);
            var text3 = document.createTextNode(dict[i]['Confidence']);

            td1.appendChild(text1);
            td2.appendChild(text2);
            td3.appendChild(text3);
            tr.appendChild(td1);
            tr.appendChild(td2);
            tr.appendChild(td3);

            table.appendChild(tr);
        }
        document.body.appendChild(table);
    };


</script>

{% endblock data %}